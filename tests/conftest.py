from typing import Dict, Tuple
import os
import pandas as pd
import numpy as np
import pytest


@pytest.fixture(scope="module")
def dummy_ratings_df() -> pd.DataFrame:
    np.random.seed(123)
    return pd.DataFrame(
        {
            "timestamp": pd.date_range(start="2022-01-01", end="2022-01-11", freq="1D"),
            "movieId": [1, 1, 1, 2, 2, 2, 3, 4, 4, 5, 5],
            "userId": [1, 2, 3, 1, 2, 3, 4, 1, 2, 1, 3],
            "rating": np.random.uniform(low=0.5, high=5.0, size=11),
        }
    )


@pytest.fixture(scope="module")
def movielens_sample() -> pd.DataFrame:
    wdir = os.path.abspath(os.curdir)
    return pd.read_csv(os.path.join(wdir, "tests", "movielens_sample.csv"))


@pytest.fixture(scope="module")
def movielens_mappings(
    movielens_sample: pd.DataFrame,
) -> Tuple[Dict[int, int], Dict[int, int]]:
    user_mapping = {
        user_id: idx
        for idx, user_id in enumerate(movielens_sample["userId"].unique().tolist())
    }
    item_mapping = {
        item_id: idx
        for idx, item_id in enumerate(movielens_sample["movieId"].unique().tolist())
    }
    return (user_mapping, item_mapping)


@pytest.fixture(scope="module")
def output_predictions_for_user_user_filtering() -> pd.DataFrame:
    return pd.DataFrame(
        {
            "movieId": {
                250: 7153,
                70: 267,
                322: 7380,
                69: 4361,
                462: 4022,
            },
            "predicted_rating": {
                250: 5.666849816849817,
                70: 5.166849816849817,
                322: 5.166849816849817,
                69: 5.166849816849817,
                462: 5.166849816849817,
            },
        }
    )


@pytest.fixture(scope="module")
def output_user_array() -> np.ndarray:
    return np.array(
        [
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ]
        ]
    )


@pytest.fixture(scope="module")
def output_batch_array() -> np.ndarray:
    return np.array(
        [
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
        ]
    )


@pytest.fixture(scope="module")
def output_reconstruction() -> np.ndarray:
    return np.array(
        [
            0.4978179335594177,
            0.4971509277820587,
            0.49958398938179016,
            0.5026978850364685,
            0.5035238862037659,
            0.502793550491333,
            0.492048978805542,
            0.5032238960266113,
            0.49991363286972046,
            0.49461740255355835,
            0.49587947130203247,
            0.5018694996833801,
            0.5005526542663574,
            0.5003678798675537,
            0.4971569776535034,
            0.503656804561615,
            0.5048025846481323,
            0.49669453501701355,
            0.5032292008399963,
            0.5005859732627869,
            0.5012413859367371,
            0.5009962320327759,
            0.5069866180419922,
            0.49616700410842896,
            0.5012696385383606,
            0.504420816898346,
            0.5055971145629883,
            0.5018914341926575,
            0.5012652277946472,
            0.5038454532623291,
            0.4937315285205841,
            0.49817755818367004,
            0.5046922564506531,
            0.5045502185821533,
            0.5017284750938416,
            0.501119077205658,
            0.4999876022338867,
            0.49840325117111206,
            0.4974645674228668,
            0.5010769367218018,
            0.505644679069519,
            0.49918121099472046,
            0.4982757568359375,
            0.5027080178260803,
            0.5019108057022095,
            0.4959820508956909,
            0.4939771294593811,
            0.5024562478065491,
            0.5026862025260925,
            0.4985821843147278,
            0.49743184447288513,
            0.5054484605789185,
            0.4967031478881836,
            0.5040624141693115,
            0.495207279920578,
            0.49557963013648987,
            0.5063687562942505,
            0.500230610370636,
            0.49955493211746216,
            0.49996206164360046,
            0.49860942363739014,
            0.5011683106422424,
            0.4999363422393799,
            0.49796774983406067,
            0.503812849521637,
            0.49939611554145813,
            0.49909472465515137,
            0.5039640665054321,
            0.5021669268608093,
            0.49336254596710205,
            0.4968377947807312,
            0.4998457133769989,
            0.49792566895484924,
            0.4946558177471161,
            0.5057479739189148,
            0.5018767714500427,
            0.5009576082229614,
            0.4970073103904724,
            0.49775221943855286,
            0.5001921653747559,
            0.49933797121047974,
            0.4985872805118561,
            0.4985436499118805,
            0.5019116401672363,
            0.5001659393310547,
            0.49788060784339905,
            0.49841463565826416,
            0.49463027715682983,
            0.5014001131057739,
            0.5011990666389465,
            0.49749618768692017,
            0.5000846982002258,
            0.4957754909992218,
            0.501808226108551,
            0.4931362271308899,
            0.5049115419387817,
            0.4994097352027893,
            0.500799834728241,
            0.497905969619751,
            0.5007705092430115,
            0.4997274875640869,
            0.500979483127594,
            0.4956997036933899,
            0.4973903298377991,
            0.5002329349517822,
            0.4995576739311218,
            0.49779874086380005,
            0.49569717049598694,
            0.5035139322280884,
            0.4979826509952545,
            0.502520740032196,
            0.5004075169563293,
            0.5027560591697693,
            0.49985557794570923,
            0.5031590461730957,
            0.49752020835876465,
            0.49672365188598633,
            0.4977824091911316,
            0.49883413314819336,
            0.501934826374054,
            0.5005736351013184,
            0.49971452355384827,
            0.5021716356277466,
            0.4974777400493622,
            0.5008900165557861,
            0.49607717990875244,
            0.5034694075584412,
            0.501169741153717,
            0.4993464946746826,
            0.5097495317459106,
            0.5002870559692383,
            0.5052227973937988,
            0.5000647902488708,
            0.4977162182331085,
            0.5046164393424988,
            0.5040493011474609,
            0.49704208970069885,
            0.5025375485420227,
            0.4985215365886688,
            0.5009640455245972,
            0.49843332171440125,
            0.5012667179107666,
            0.49969473481178284,
            0.5011834502220154,
            0.5029544830322266,
            0.49911123514175415,
            0.49862176179885864,
            0.5002745389938354,
            0.5088930726051331,
            0.4980374574661255,
            0.5020068287849426,
            0.5073628425598145,
            0.500405490398407,
            0.5035296082496643,
            0.49978455901145935,
            0.5028570890426636,
            0.4996359050273895,
            0.4985804557800293,
            0.4956585764884949,
            0.5005289316177368,
            0.5000203847885132,
            0.49514657258987427,
            0.5016945600509644,
            0.4981571435928345,
            0.503822386264801,
            0.5030859112739563,
            0.5026930570602417,
            0.5027382373809814,
            0.49206334352493286,
            0.5028665065765381,
            0.5012022852897644,
            0.5028290748596191,
            0.49449270963668823,
            0.4991890490055084,
            0.5014312863349915,
            0.4967567026615143,
            0.5048526525497437,
            0.48919835686683655,
            0.49713659286499023,
            0.49966591596603394,
            0.4970349967479706,
            0.49218833446502686,
            0.5003692507743835,
            0.504386305809021,
            0.4993732273578644,
            0.504044771194458,
            0.5009787678718567,
            0.5008357763290405,
            0.4987141489982605,
            0.5044037699699402,
            0.4984564185142517,
            0.4975378215312958,
            0.4993516504764557,
            0.49490323662757874,
            0.5004558563232422,
            0.4977850615978241,
            0.4955929219722748,
            0.4966289699077606,
            0.49978023767471313,
            0.5023583769798279,
            0.49784061312675476,
            0.5012543201446533,
            0.49629759788513184,
            0.4973081648349762,
            0.5003157258033752,
            0.5012022852897644,
            0.5040039420127869,
            0.49233540892601013,
            0.5023940801620483,
            0.4980812966823578,
            0.5025866031646729,
            0.5013788342475891,
            0.4999227821826935,
            0.49885982275009155,
            0.5014821887016296,
            0.49856409430503845,
            0.5013629198074341,
            0.5020034909248352,
            0.500251829624176,
            0.501873791217804,
            0.50555419921875,
            0.501295268535614,
            0.5072962045669556,
            0.5066301226615906,
            0.5028470754623413,
            0.4994315803050995,
            0.49361151456832886,
            0.49554896354675293,
            0.4993366599082947,
            0.5000534653663635,
            0.4988424777984619,
            0.49801212549209595,
            0.5028055310249329,
            0.5038778781890869,
            0.49709734320640564,
            0.502172589302063,
            0.49814897775650024,
            0.506060004234314,
            0.5032942295074463,
            0.4999336302280426,
            0.49321481585502625,
            0.4994924068450928,
            0.5033513307571411,
            0.5009192824363708,
            0.4896685481071472,
            0.49418729543685913,
            0.49358853697776794,
            0.4972606897354126,
            0.5008211135864258,
            0.5004668235778809,
            0.4953734874725342,
            0.49800920486450195,
            0.502163827419281,
            0.500511646270752,
            0.49533581733703613,
            0.5021779537200928,
            0.49497416615486145,
            0.5046609044075012,
            0.49710536003112793,
            0.5092957615852356,
            0.49551498889923096,
            0.49996688961982727,
            0.5031901001930237,
            0.5003486275672913,
            0.4980507791042328,
            0.5014625191688538,
            0.4961147606372833,
            0.4958164691925049,
            0.5004922747612,
            0.5024860501289368,
            0.497162401676178,
            0.49463242292404175,
            0.49660342931747437,
            0.5023070573806763,
            0.49982962012290955,
            0.5049852728843689,
            0.504540741443634,
            0.5017991662025452,
            0.49731239676475525,
            0.5014377236366272,
            0.49839940667152405,
            0.49396276473999023,
            0.49962568283081055,
            0.4974741041660309,
            0.49864262342453003,
            0.49662843346595764,
            0.4956485331058502,
            0.4920988976955414,
            0.49681830406188965,
            0.49345827102661133,
            0.4988192915916443,
            0.49878647923469543,
            0.4969731569290161,
            0.49651914834976196,
            0.49879366159439087,
            0.5003653168678284,
            0.5016919374465942,
            0.5038122534751892,
            0.5020170211791992,
            0.49882790446281433,
            0.49806907773017883,
            0.4949689209461212,
            0.5042710304260254,
            0.4973434805870056,
            0.4991627037525177,
            0.5050573348999023,
            0.4951150119304657,
            0.5027263760566711,
            0.5007244944572449,
            0.4988296926021576,
            0.49730679392814636,
            0.5019087791442871,
            0.49537238478660583,
            0.49563682079315186,
            0.5040938854217529,
            0.49781298637390137,
            0.49844393134117126,
            0.49761924147605896,
            0.49484625458717346,
            0.5070427656173706,
            0.49488359689712524,
            0.49582555890083313,
            0.5004865527153015,
            0.49251553416252136,
            0.48767587542533875,
            0.49681606888771057,
            0.49934956431388855,
            0.49965181946754456,
            0.496846467256546,
            0.4994683861732483,
            0.49517518281936646,
            0.49915245175361633,
            0.4971230924129486,
            0.502654492855072,
            0.4951871335506439,
            0.4995502531528473,
            0.5022869110107422,
            0.4990163743495941,
            0.5015571713447571,
            0.49763405323028564,
            0.5010770559310913,
            0.4978066086769104,
            0.503473162651062,
            0.5009394288063049,
            0.4997144341468811,
            0.4956551790237427,
            0.4958648383617401,
            0.4994897246360779,
            0.49994638562202454,
            0.4996652901172638,
            0.49491193890571594,
            0.4983765184879303,
            0.4931657016277313,
            0.5011617541313171,
            0.5028254985809326,
            0.49865227937698364,
            0.5040733814239502,
            0.4969133734703064,
            0.5001653432846069,
            0.5006213188171387,
            0.4998607039451599,
            0.49046003818511963,
            0.4996292293071747,
            0.5053691267967224,
            0.49731847643852234,
            0.4951273798942566,
            0.49944067001342773,
            0.49742984771728516,
            0.5008704662322998,
            0.4903249740600586,
            0.49910515546798706,
            0.5031819939613342,
            0.504890501499176,
            0.5034067630767822,
            0.49891602993011475,
            0.4955495595932007,
            0.49447545409202576,
            0.49788838624954224,
            0.4938426911830902,
            0.4994391202926636,
            0.500659167766571,
            0.501940131187439,
            0.49932193756103516,
            0.4992888867855072,
            0.4994824528694153,
            0.4992404580116272,
            0.5005767345428467,
            0.49695295095443726,
            0.5027052164077759,
            0.49802640080451965,
            0.4956713318824768,
            0.5012345314025879,
            0.4922904074192047,
            0.49310657382011414,
            0.4981553852558136,
            0.5026040077209473,
            0.49901941418647766,
            0.4983443319797516,
            0.49229535460472107,
            0.49605801701545715,
            0.4991791248321533,
            0.4927522540092468,
            0.5006309747695923,
            0.49346813559532166,
            0.49680835008621216,
            0.49966344237327576,
            0.4954456090927124,
            0.49780547618865967,
            0.49793732166290283,
            0.49833330512046814,
            0.49932992458343506,
            0.5025240778923035,
            0.5040741562843323,
            0.49879688024520874,
            0.49308428168296814,
            0.49990564584732056,
            0.4957726299762726,
            0.5020518898963928,
            0.49597564339637756,
            0.49632614850997925,
            0.4945210814476013,
            0.49407142400741577,
            0.4966345429420471,
            0.49335259199142456,
            0.5018634796142578,
            0.4939703941345215,
            0.5028545260429382,
            0.49557799100875854,
            0.4957922101020813,
            0.5035277605056763,
            0.5020593404769897,
            0.4925650954246521,
            0.5009640455245972,
            0.49683472514152527,
            0.4981498122215271,
            0.4980083107948303,
            0.5026410818099976,
            0.4938443899154663,
            0.5054993629455566,
            0.5065829157829285,
            0.49851685762405396,
            0.5023937225341797,
            0.49279868602752686,
            0.493856817483902,
            0.49610745906829834,
            0.4940797686576843,
            0.5030070543289185,
            0.49825334548950195,
            0.4910217225551605,
            0.49618402123451233,
            0.4955405294895172,
            0.49337005615234375,
            0.49609100818634033,
            0.49663642048835754,
            0.4996635913848877,
            0.5030098557472229,
            0.4972648024559021,
            0.4982440769672394,
            0.4899460971355438,
            0.49997565150260925,
            0.49810442328453064,
            0.49911919236183167,
            0.4960877299308777,
            0.498220294713974,
            0.4971370995044708,
            0.498675674200058,
            0.49743178486824036,
            0.4991207420825958,
            0.4956594407558441,
            0.49892398715019226,
            0.49609267711639404,
            0.4974675476551056,
            0.49810487031936646,
            0.5000075697898865,
            0.49768900871276855,
            0.4969848096370697,
            0.4987535774707794,
            0.5001980066299438,
            0.4939371645450592,
            0.508270800113678,
            0.4948447346687317,
            0.500508725643158,
            0.49002131819725037,
            0.4978356957435608,
            0.4928869307041168,
            0.49894285202026367,
            0.49434375762939453,
            0.4916306138038635,
            0.5023692846298218,
            0.4969162046909332,
            0.49254530668258667,
            0.49738800525665283,
            0.49359753727912903,
            0.5012056827545166,
            0.49467700719833374,
            0.4972400367259979,
            0.5018512010574341,
            0.49643802642822266,
            0.4999319612979889,
            0.4953349828720093,
            0.49705809354782104,
            0.49284303188323975,
            0.5016645193099976,
            0.4963689148426056,
            0.4976218342781067,
            0.5016589760780334,
            0.4960314631462097,
            0.4966834783554077,
            0.5017622113227844,
            0.49550455808639526,
            0.5036182999610901,
            0.49450135231018066,
            0.4990909695625305,
            0.49905991554260254,
            0.5027598142623901,
            0.4968898296356201,
            0.5065481066703796,
            0.495902955532074,
            0.5061046481132507,
            0.49916842579841614,
            0.49416568875312805,
            0.49642395973205566,
            0.4945133626461029,
            0.5005773901939392,
            0.5032086968421936,
            0.5019163489341736,
            0.4976474940776825,
            0.49118927121162415,
            0.4919036030769348,
            0.49599695205688477,
            0.49710723757743835,
            0.4961298704147339,
            0.4954063892364502,
            0.49402058124542236,
            0.49679139256477356,
            0.4996229410171509,
            0.5008147358894348,
            0.4988771378993988,
            0.4999331831932068,
            0.4940637946128845,
            0.4936272203922272,
            0.5017090439796448,
            0.4963099956512451,
            0.501876711845398,
        ]
    )
